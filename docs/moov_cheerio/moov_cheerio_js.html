<body>

<div class="split-container">
  <div data-section="accordion" id="content-nav" class="module-nav media">
    <div class="module-sidebar" id="content-sidebar"><div class='sidebar-head'>moov_cheerio</div><div class='sidebar-body'><a href='/modules/moov_cheerio/index' class='L1'>README</a><div class='L1-container'><div class='L1-button'><a href="$" class="L1">$ Namespace</a></div><ul class='methods L1-content'><li data-type='method'><a href="$#.add" class="L1">.add()</a></li><li data-type='method'><a href="$#.addBack" class="L1">.addBack()</a></li><li data-type='method'><a href="$#.addClass" class="L1">.addClass()</a></li><li data-type='method'><a href="$#.after" class="L1">.after()</a></li><li data-type='method'><a href="$#.append" class="L1">.append()</a></li><li data-type='method'><a href="$#.appendText" class="L1">.appendText()</a></li><li data-type='method'><a href="$#.attr" class="L1">.attr()</a></li><li data-type='method'><a href="$#.attributes" class="L1">.attributes()</a></li><li data-type='method'><a href="$#.before" class="L1">.before()</a></li><li data-type='method'><a href="$#.children" class="L1">.children()</a></li><li data-type='method'><a href="$#.clone" class="L1">.clone()</a></li><li data-type='method'><a href="$#.closest" class="L1">.closest()</a></li><li data-type='method'><a href="$#.contents" class="L1">.contents()</a></li><li data-type='method'><a href="$#.create" class="L1">.create()</a></li><li data-type='method'><a href="$#.createAfter" class="L1">.createAfter()</a></li><li data-type='method'><a href="$#.createBefore" class="L1">.createBefore()</a></li><li data-type='method'><a href="$#.createBottom" class="L1">.createBottom()</a></li><li data-type='method'><a href="$#.createTop" class="L1">.createTop()</a></li><li data-type='method'><a href="$#.css" class="L1">.css()</a></li><li data-type='method'><a href="$#.data" class="L1">.data()</a></li><li data-type='method'><a href="$#.domManipulator" class="L1">.domManipulator()</a></li><li data-type='method'><a href="$#.dumpTable" class="L1">.dumpTable()</a></li><li data-type='method'><a href="$#.dumpTables" class="L1">.dumpTables()</a></li><li data-type='method'><a href="$#.each" class="L1">.each()</a></li><li data-type='method'><a href="$#.empty" class="L1">.empty()</a></li><li data-type='method'><a href="$#.end" class="L1">.end()</a></li><li data-type='method'><a href="$#.eq" class="L1">.eq()</a></li><li data-type='method'><a href="$#.filter" class="L1">.filter()</a></li><li data-type='method'><a href="$#.find" class="L1">.find()</a></li><li data-type='method'><a href="$#.first" class="L1">.first()</a></li><li data-type='method'><a href="$#.get" class="L1">.get()</a></li><li data-type='method'><a href="$#.has" class="L1">.has()</a></li><li data-type='method'><a href="$#.hasClass" class="L1">.hasClass()</a></li><li data-type='method'><a href="$#" class="L1">.html()</a></li><li data-type='method'><a href="$#.index" class="L1">.index()</a></li><li data-type='method'><a href="$#.insertAfter" class="L1">.insertAfter()</a></li><li data-type='method'><a href="$#.insertBefore" class="L1">.insertBefore()</a></li><li data-type='method'><a href="$#.is" class="L1">.is()</a></li><li data-type='method'><a href="$#.last" class="L1">.last()</a></li><li data-type='method'><a href="$#.makeToggler" class="L1">.makeToggler()</a></li><li data-type='method'><a href="$#.map" class="L1">.map()</a></li><li data-type='method'><a href="$#.move" class="L1">.move()</a></li><li data-type='method'><a href="$#.moveAfter" class="L1">.moveAfter()</a></li><li data-type='method'><a href="$#.moveBefore" class="L1">.moveBefore()</a></li><li data-type='method'><a href="$#.moveBottom" class="L1">.moveBottom()</a></li><li data-type='method'><a href="$#.moveTop" class="L1">.moveTop()</a></li><li data-type='method'><a href="$#.name" class="L1">.name()</a></li><li data-type='method'><a href="$#.next" class="L1">.next()</a></li><li data-type='method'><a href="$#.nextAll" class="L1">.nextAll()</a></li><li data-type='method'><a href="$#.nextUntil" class="L1">.nextUntil()</a></li><li data-type='method'><a href="$#.not" class="L1">.not()</a></li><li data-type='method'><a href="$#.parent" class="L1">.parent()</a></li><li data-type='method'><a href="$#.parents" class="L1">.parents()</a></li><li data-type='method'><a href="$#.parentsUntil" class="L1">.parentsUntil()</a></li><li data-type='method'><a href="$#.prepend" class="L1">.prepend()</a></li><li data-type='method'><a href="$#.prependText" class="L1">.prependText()</a></li><li data-type='method'><a href="$#.prev" class="L1">.prev()</a></li><li data-type='method'><a href="$#.prevAll" class="L1">.prevAll()</a></li><li data-type='method'><a href="$#.prevUntil" class="L1">.prevUntil()</a></li><li data-type='method'><a href="$#.remove" class="L1">.remove()</a></li><li data-type='method'><a href="$#.removeAttr" class="L1">.removeAttr()</a></li><li data-type='method'><a href="$#.removeAttrs" class="L1">.removeAttrs()</a></li><li data-type='method'><a href="$#.removeClass" class="L1">.removeClass()</a></li><li data-type='method'><a href="$#.removeIfEmpty" class="L1">.removeIfEmpty()</a></li><li data-type='method'><a href="$#.removeTextNodes" class="L1">.removeTextNodes()</a></li><li data-type='method'><a href="$#.replace" class="L1">.replace()</a></li><li data-type='method'><a href="$#.replaceWith" class="L1">.replaceWith()</a></li><li data-type='method'><a href="$#.revertDumpTable" class="L1">.revertDumpTable()</a></li><li data-type='method'><a href="$#.serializeArray" class="L1">.serializeArray()</a></li><li data-type='method'><a href="$#.setLower" class="L1">.setLower()</a></li><li data-type='method'><a href="$#.setText" class="L1">.setText()</a></li><li data-type='method'><a href="$#.setUpper" class="L1">.setUpper()</a></li><li data-type='method'><a href="$#.siblings" class="L1">.siblings()</a></li><li data-type='method'><a href="$#.slice" class="L1">.slice()</a></li><li data-type='method'><a href="$#.text" class="L1">.text()</a></li><li data-type='method'><a href="$#.toArray" class="L1">.toArray()</a></li><li data-type='method'><a href="$#.toggleClass" class="L1">.toggleClass()</a></li><li data-type='method'><a href="$#.trim" class="L1">.trim()</a></li><li data-type='method'><a href="$#.unwrap" class="L1">.unwrap()</a></li><li data-type='method'><a href="$#.val" class="L1">.val()</a></li><li data-type='method'><a href="$#.wrap" class="L1">.wrap()</a></li><li data-type='method'><a href="$#.wrapInner" class="L1">.wrapInner()</a></li><li data-type='method'><a href="$#.wrapNonemptyTextChildren" class="L1">.wrapNonemptyTextChildren()</a></li><li data-type='method'><a href="$#.wrapTextChildren" class="L1">.wrapTextChildren()</a></li><li data-type='method'><a href="$#.wrapTogether" class="L1">.wrapTogether()</a></li></ul></div><div class="L1-container"><div class="L1-button"><a href="/modules/moov_cheerio/global" class="L1"><em>Global</em> Namespace</a></div><ul class="L1-content"><li><a href="global#tag" class="L1">tag</a></li><li><a href="global#txt" class="L1">txt</a></li></ul></div></div></div>
  </div>

  <div id="main" class="module-content data">
      
      <div class="breadcrumbs">
        <a href="/">Home</a>
        &raquo; <a href="/docs">Documentation</a>
        &raquo; <a href="/modules/moov_cheerio/index">moov_cheerio</a>
        &raquo; moov_cheerio.js
      </div>
      <h1 class="page-title">moov_cheerio.js</h1>
      

      



    
    <section>
        <article>
            <pre class="source"><code class="language-javascript">/* globals tag, txt */
'use strict';

const cheerio = require('cheerio');

cheerio.prototype.options.withDomLvl1 = false;

const slice = Array.prototype.slice;

function copy(node, children, next, prev, parent) {
    return {
        // __proto__: node.__proto__, // uncomment if withDomLvl1 is true
        type: node.type,
        name: node.name,
        attribs: node.attribs,
        children: children,
        next: next,
        prev: prev,
        parent: parent
    };
}

/**
 * @function tag
 * @summary moov_cheerio
 * @description Creates a new element. Note that this is &lt;i>not&lt;/i> a Cheerio
 * object: you should wrap it in `$()` if Cheerio methods need to be invoked on
 * it.
 * @param {String} name A string for the name of the element.
 * @param {Object} [attribs] An object containing the attribute-value pairs of
 * the new element.
 * @param {String} [content] A string for the text node for the new element.
 * @return {Object} An object associated with the newly-created DOM element.
 * defined by the arguments passed in (denoted by a `type` value of "tag").
 * @example
 * let grape = tag("li", {class: "grape"}, "Grape");
 * grape.insertAfter(".apple");
 * // => Throws: TypeError (grape is not a Cheerio object, and the object
 * //    associated with the grape DOM element does not have an insertAfter
 * //    method defined)
 * $body.find("ul").append(grape);
 * // => Note: This is OK - you can append a non-Cheerio object here
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="grape">Grape&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //    &lt;/ul>
 * @example
 * let $grape = $(tag("div", {class: "grape"}, "Grape"));
 * $grape.insertAfter(".apple");
 * // => Returns: original Cheerio object associated with the newly-created
 * //    `.grape` element
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="grape">Grape&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //    &lt;/ul>
 */
global.tag = function(name, attribs, content) {
    let type = name === 'script' || name === 'style' ? name : 'tag';
    return {
        // for some reason &lt;script> and &lt;style> aren't exactly elements in htmlparser2
        // __proto__: type == 'tag' ? ElementPrototype : NodePrototype, // uncomment if withDomLvl1 is true
        type: type,
        name: name,
        attribs: attribs || {},
        children: content ? [txt(content)] : [],
        next: null,
        prev: null,
        parent: null
    };
};

/**
 * @function txt
 * @summary moov_cheerio
 * @description Creates a new text node.
 * @param {string} content A string for the content that the text node will
 * contain.
 * @return {Object} An object associated with the newly-created text node
 * defined by the `content` argument passed in (denoted by a `type` value of
 * "text").
 * @example
 * $body.find(".apple").append(txt(", more text"));
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple, more text&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //    &lt;/ul>
 *
 */
global.txt = function(content) {
    return {
        // __proto__: NodePrototype, // uncomment if withDomLvl1 is true
        data: content,
        type: 'text',
        next: null,
        prev: null,
        parent: null
    };
};

/**
 * @method replace
 * @summary moov_cheerio
 * @memberof $
 * @description Replaces all or a portion of an old value of an attribute with a
 * new value.
 * @param {string} attr A string for the attribute whose value is to be
 * replaced.
 * @param {string} oldval A string for the old value to be replaced.
 * @param {string} newval A string for a new value to replace the old value.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".apple").replace("data-which", "uji", "lorina");
 * // => Returns: original Cheerio object associated with $body.find(".apple")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="florina">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.replace = function(attr, oldVal, newVal) {
    for (let i = 0, len = this.length; i &lt; len; i++) {
        if (this[i].type === 'tag') {
            if (this[i].attribs[attr] !== undefined) {
                this[i].attribs[attr] = this[i].attribs[attr].replace(oldVal, newVal);
            }
        }
    }
    return this;
};

/**
 * @method name
 * @summary moov_cheerio
 * @memberof $
 * @description Changes the node names of each element in the matched set.
 * @param {string} tagName A string for the new tag name.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("ul").name("ol");
 * // => Returns: original Cheerio object originally associated with
 * //    $body.find("ul") (which is now the ol)
 * // => HTML output:
 * //    &lt;ol id="fruits">
 * //      &lt;li class="apple" data-which="florina">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ol>
 */
cheerio.prototype.name = function(tagName) {
    for (let i = 0, len = this.length; i &lt; len; i++) {
        this[i].name = tagName;
    }
    return this;
};

/**
 * @method removeAttrs
 * @summary moov_cheerio
 * @memberof $
 * @description Removes all attributes for each element in the matched set.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".apple").removeAttrs();
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li>Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.removeAttrs = function() {
    for (let i = 0, len = this.length; i &lt; len; i++) {
        this[i].attribs = {};
    }
    return this;
};

// [Note: all .wrap()-related methods are all written with a specific signature,
// since the originals naturally accept "tag()" arguments. However, they are
// documented to coerce arguments into that form, so that they can take
// arguments in the way that tag() does.]

/**
 * @method wrapTextChildren
 * @summary moov_cheerio
 * @memberof $
 * @description Wraps any text nodes for each element in the matched set. This
 * includes text nodes that are comprised entirely of whitespace.
 * @param {String} name A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("li").wrapTextChildren("span", {class: "text"});
 * // => Returns: original Cheerio object originally with $body.find("li")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">&lt;span class="text">Apple&lt;/span>&lt;/li>
 * //      &lt;li class="orange">&lt;span class="text">Orange&lt;/span>&lt;/li>
 * //      &lt;li class="pear">&lt;span class="text">Pear&lt;/span>&lt;/li>
 * //    &lt;/ul>
 * @example
 * $body.find("ul").wrapTextChildren("li", {class: "text"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">&lt;li class="text">
 * //    &lt;/li>&lt;li class="apple" data-which="fuji">Apple&lt;/li>&lt;li class="text">
 * //    &lt;/li>&lt;li class="orange">Orange&lt;/li>&lt;li class="text">
 * //    &lt;/li>&lt;li class="pear">Pear&lt;/li>&lt;li class="text">
 * //    &lt;/li>&lt;/ul>
 */
cheerio.prototype.wrapTextChildren = function(node, ignore_empty) {
    if (typeof node !== 'object') {
        node = tag.apply(null, arguments);
    }

    for (let i = 0, len = this.length; i &lt; len; i++) {
        let elem = this[i], children = elem.children;
        for (let i = 0, len = children.length; i &lt; len; i++) {
            let child = children[i];
            if (child.type === 'text') {
                if ( (child.data === null || child.data.trim() === '') &amp;&amp; ignore_empty === true) {
                    // if empty and we are ignoring empty, do nothing
                } else {
                    let clone = copy(node, [child], child.next, child.prev, child.parent);
                    let next = child.next, prev = child.prev, root = child.root;
                    if (next) {
                        next.prev = clone;
                    }
                    if (prev) {
                        prev.next = clone;
                    }
                    if (root) {
                        clone.root = root;
                        child.root = null;
                    }
                    child.next = child.prev = null;
                    child.parent = clone;
                    children[i] = clone;
                }
            }
        }
    }

    return this;
};

/**
 * @method wrap
 * @summary moov_cheerio
 * @memberof $
 * @description Wraps each element in the matched set with a newly-defined input
 * element. Note that this is different from the original Cheerio's .wrap()
 * implementation.
 * @param {String} name A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("#fruits").wrap("div", {class: "wrapper"});
 * // => Returns: original Cheerio object originally with $body.find("#fruits")
 * // => HTML output:
 * //    &lt;div class="wrapper">
 * //      &lt;ul id="fruits">
 * //        &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //        &lt;li class="orange">Orange&lt;/li>
 * //        &lt;li class="pear">Pear&lt;/li>
 * //      &lt;/ul>
 * //    &lt;/div>
 */
cheerio.prototype.wrap = function(node) {
    if (typeof node !== 'object') {
        node = tag.apply(null, arguments);
    }
    for (let i = 0, len = this.length; i &lt; len; i++) {
        let elem = this[i], parent = elem.parent;
        let siblings = parent ? parent.children : elem.root.children;
        let clone = copy(node, [elem], elem.next, elem.prev, elem.parent);
        let next = elem.next, prev = elem.prev, root = elem.root;
        if (next) {
            next.prev = clone;
        }
        if (prev) {
            prev.next = clone;
        }
        if (root) {
            clone.root = root;
            elem.root = null;
        }
        elem.next = elem.prev = null;
        elem.parent = clone;
        siblings[siblings.indexOf(elem)] = clone;
    }
    return this;
};

/**
 * @method wrapInner
 * @summary moov_cheerio
 * @memberof $
 * @description Wraps inner contents of each element in the matched set.
 * @param {String} name A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("#fruits").name("div");
 * $body.find("#fruits").wrapInner("ol", {class: "fruits-inner"});
 * // => Returns: original Cheerio object originally with $body.find("#fruits")
 * // => HTML output:
 * //    &lt;div id="fruits">
 * //      &lt;ol class="fruits-inner">
 * //        &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //        &lt;li class="orange">Orange&lt;/li>
 * //        &lt;li class="pear">Pear&lt;/li>
 * //      &lt;/ol>
 * //    &lt;/div>
 */
cheerio.prototype.wrapInner = function(node) {
    if (typeof node !== 'object') {
        node = tag.apply(null, arguments);
    }
    for (let i = 0, len = this.length; i &lt; len; i++) {
        let elem = this[i], children = elem.children;
        let clone = copy(node, children, null, null, elem);
        for (let i = 0, len = children.length; i &lt; len; i++) {
            children[i].parent = clone;
        }
        elem.children = [clone];
    }
    return this;
};

/**
 * @method wrapTogether
 * @summary moov_cheerio
 * @memberof $
 * @description Wraps all elements in a matched set under a single newly-defined
 * element, and insert this new element where the first element in the matched
 * set once was.
 * @param {String} name A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("#fruits").name("div");
 * $body.find("li").wrapTogether("ol", {class: "fruits-inner"});
 * // => Returns: original Cheerio object originally with $body.find("li")
 * // => HTML output:
 * //    &lt;div id="fruits">
 * //      &lt;ol class="fruits-inner">
 * //        &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //        &lt;li class="orange">Orange&lt;/li>
 * //        &lt;li class="pear">Pear&lt;/li>
 * //      &lt;/ol>
 * //    &lt;/div>
 */
cheerio.prototype.wrapTogether = function(node) {
    if (typeof node !== 'object') {
        node = tag.apply(null, arguments);
    }
    if (this.length === 0) {
        return this;
    }
    let first = this[0],
        parent = first.parent,
        siblings = parent.children,
        root = first.root;
    first.parent = {};
    let clone = copy(node, slice.call(this), first.next, first.prev, parent);
    if (root) {
        clone.root = root;
    }

    for (let i = 0, len = this.length; i &lt; len; i++) {
        let elem = this[i],
            next = elem.next,
            prev = elem.prev,
            parent = elem.parent,
            siblings = parent ? parent.children : elem.root.children,
            root = elem.root;
        if (next) {
            next.prev = prev;
        }
        if (prev) {
            prev.next = next;
        }
        elem.next = this[i+1] || null;
        elem.prev = this[i-1] || null;
        elem.parent = clone;
        if (root) {
            elem.root = null;
        }
        if (siblings) {
            siblings.splice(siblings.indexOf(elem), 1);
        }
    }
    siblings[siblings.indexOf(first)] = clone;
    return this;
};

/**
 * @method unwrap
 * @summary moov_cheerio
 * @memberof $
 * @description Removes the wrapping element while retaining selected element
 * itself, for each element in the matched set.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("ul").unwrap();
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //    &lt;li class="orange">Orange&lt;/li>
 * //    &lt;li class="pear">Pear&lt;/li>
 */
cheerio.prototype.unwrap = function() {
    var copies = this.children();
    this.replaceWith(copies);
};

/**
 * @method attributes
 * @summary moov_cheerio
 * @memberof $
 * @description Updates the set of attributes for each element in the matched
 * set. If an attribute in the input is undefined, it will remove that attribute
 * from the selected nodes.
 * @param {Object} attributes Attribute-value pairs in key-value object
 * notation.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("ul").attributes({id: "food", "data-type": "fruits"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="food" data-type="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * $body.find("ul").attributes({id: undefined});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.attributes = function(attributes) {
    for (let i = 0, len = this.length; i &lt; len; i++) {
        for (let attr in attributes) {
            if (attributes[attr] !== undefined) {
                this[i].attribs[attr] = attributes[attr];
            }
            else {
                delete this[i].attribs[attr];
            }
        }
    }
    return this;
};

/**
 * @method removeTextNodes
 * @summary moov_cheerio
 * @memberof $
 * @description Removes text nodes for each element in the matched set.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".apple").removeTextNodes();
 * // => Returns: original Cheerio object originally with $body.find(".apple")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * $body.find("ul").removeTextNodes();
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">&lt;li class="apple" data-which="fuji">Apple&lt;/li>&lt;li class="orange">Orange&lt;/li> &lt;li class="pear">Pear&lt;/li>&lt;/ul>
 */
cheerio.prototype.removeTextNodes = function() {
    for (let i = 0, len = this.length; i &lt; len; i++) {
        let elem = this[i], children = elem.children;
        if (elem.type === 'text') {
            elem.remove();
        }
        for (let i = 0, len = children.length; i &lt; len; i++) {
            let child = children[i];
            if (child !== undefined &amp;&amp; child.type === 'text') {
                if (child.next !== null) {
                    let next_child = child.next;
                    next_child.prev = child.prev;
                }
                elem.children.splice(i,1);
            }
        }
    }
    return this;
};

/**
 * @method trim
 * @summary moov_cheerio
 * @memberof $
 * @description Trims whitespace for each element in the matched set. Only looks
 * one level deep for whitespace; nested text nodes remain untouched.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * let $grape = $(tag("li", {class: "grape"}, "     Grape     "));
 * $body.find("ul").append($grape);
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="grape">     Grape     &lt;/li>
 * //    &lt;/ul>
 * $grape.trim();
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="grape">Grape&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.trim = function() {
    for (let i = 0, len = this.length; i &lt; len; i++) {
        let elem = this[i], children = elem.children;
        if (elem.type === 'text') {
            elem.data.trim();
        }
        for (let i = 0, len = children.length; i &lt; len; i++) {
            let child = children[i];
            if (child.type === 'text') {
                child.data = child.data.trim();
            }
        }
    }
    return this;
};

/**
 * @method removeIfEmpty
 * @summary moov_cheerio
 * @memberof $
 * @description Removes each element in a matched set, if it has no content
 * inside. Trims the selection, then removes any nodes that have no hide param
 * is for when we can't remove the element(s).
 * @param {Object}  [options] An object of options.
 * @param {Boolean} [options.hide] A boolean stating whether the elements should
 * instead have "mw-hide" and "mw-hidden-empty-element" classes added, instead
 * of being removed completely.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * let $apple = $body.find(".apple");
 * $apple.removeIfEmpty();
 * // => Returns: original Cheerio object originally with $body.find(".apple")
 * // => HTML output (stays the same):
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * $apple.empty();
 * $apple.removeIfEmpty();
 * // => Returns: original Cheerio object originally with $body.find(".apple")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.removeIfEmpty = function (options) {
    options = options || {};

    let elements = this.filter(':not(.mw-not-remove)');
    let elementsKeys = Object.keys(this).reverse().filter(function (value) {
        return !isNaN(+value);
    });

    elementsKeys.forEach(function (key) {
        let element = cheerio(elements[key]);

        element.contents().each(function () {
          let content = cheerio(this);
          if( content[0].type === "text" &amp;&amp; content.text().trim() === "") {
            content.remove();
          }
        });

        if(element.contents().length === 0) {
          if(options.hide) {
            element.addClass('mw-hide mw-hidden-empty-element');
          } else {
            element.remove();
          }
        }
    });

    return this;
};

/**
 * @method wrapNonemptyTextChildren
 * @summary moov_cheerio
 * @memberof $
 * @description Wraps any text nodes for each element in the matched set. This
 * differs from wrapTextChildren(), since this ignores text nodes that are
 * comprised entirely of whitespace.
 * @param {String} name A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("li").wrapNonemptyTextChildren("span", {class: "text"});
 * // => Returns: original Cheerio object originally with $body.find("li")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">&lt;span class="text">Apple&lt;/span>&lt;/li>
 * //      &lt;li class="orange">&lt;span class="text">Orange&lt;/span>&lt;/li>
 * //      &lt;li class="pear">&lt;span class="text">Pear&lt;/span>&lt;/li>
 * //    &lt;/ul>
 * @example
 * $body.find("ul").wrapNonemptyTextChildren("li", {class: "text"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output (stays the same):
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.wrapNonemptyTextChildren = function(node) {
    if (typeof node !== 'object') {
        node = tag.apply(null, arguments);
    }
    return this.wrapTextChildren(node, true);
};

/**
 * @method setText
 * @summary moov_cheerio
 * @memberof $
 * @description Performs a regular expression replacement for each element in
 * the matched set.
 * @param {string} reg1 Original text.
 * @param {string} reg2 New text.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find("li").setText("e", "x");
 * // => Returns: original Cheerio object originally with $body.find("li")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Applx&lt;/li>
 * //      &lt;li class="orange">Orangx&lt;/li>
 * //      &lt;li class="pear">Pxar&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.setText = function(reg1, reg2) {
  this.each(function(i, elem) {
    var new_text = cheerio(elem).text().replace(reg1, reg2);
    cheerio(elem).text(new_text);
  });
  return this;
};

/**
 * @method setUpper
 * @summary moov_cheerio
 * @memberof $
 * @description Sets the text of each element in the matched set to uppercase.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".apple").setUpper();
 * // => Returns: original Cheerio object originally with $body.find(".apple")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">APPLE&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.setUpper = function() {
  this.each(function(i, elem) {
    var new_text = cheerio(elem).text().toUpperCase();
    cheerio(elem).text(new_text);
  });
  return this;
};

/**
 * @method setLower
 * @summary moov_cheerio
 * @memberof $
 * @description Sets the text of each element in the matched set to lowercase.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".apple").setLower();
 * // => Returns: original Cheerio object originally with $body.find(".apple")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.setLower = function() {
  this.each(function(i, elem) {
    var new_text = cheerio(elem).text().toLowerCase();
    cheerio(elem).text(new_text);
  });
  return this;
};

/**
 * @method dumpTables
 * @summary moov_cheerio
 * @memberof $
 * @description Dumps all tables under each element of the matched set.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * let $ul = $body.find("ul");
 * let $table = $(tag("table"));
 * let $thead = $(tag("thead"));
 * let $tr1 = $(tag("tr"));
 * let $th = $(tag("th"));
 * let $tbody = $(tag("tbody"));
 * let $tr2 = $(tag("tr"));
 * let $td= $(tag("td"));
 * let $tfoot = $(tag("tfoot"));
 * let $tableClone;
 *
 * $table.append($thead.append($tr1.append($th)));
 * $table.append($tbody.append($tr2.append($td)));
 * $table.append($tfoot);
 *
 * // create a clone to see that all given tables get dumped
 * $tableClone = $table.clone();
 * $tableClone.addClass("table-clone");
 * $ul.after($table);
 * $ul.after($tableClone);
 *
 * $body.dumpTables();
 * // => Returns: original Cheerio object associated with $body
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div class="table-clone mw-was-table">
 * //      &lt;div class="mw-was-thead">
 * //        &lt;div class="mw-was-th">&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tbody">
 * //        &lt;div class="mw-was-td>&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tfoot">&lt;/div>
 * //    &lt;/div>
 * //    &lt;div class="mw-was-table">
 * //      &lt;div class="mw-was-thead">
 * //        &lt;div class="mw-was-th">&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tbody">
 * //        &lt;div class="mw-was-td>&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tfoot">&lt;/div>
 * //    &lt;/div>
 */
cheerio.prototype.dumpTables = function() {
  this.find("table, thead, tbody, tfoot, tr, td, th").each(function(){
    let nodeName = this.name;
    cheerio(this).name("div")
      .removeAttr("width")
      .removeAttr("height")
      .removeAttr("style")
      .removeAttr("cellpadding")
      .removeAttr("cellspacing")
      .removeAttr("colspan")
      .removeAttr("rowspan")
      .addClass("mw-was-" + nodeName);
  });
  return this;
}

/**
 * @method dumpTable
 * @summary moov_cheerio
 * @memberof $
 * @description Converts selected tables into a div structure. It removes the
 * original table attributes and adds classnames corresponding to its former
 * node name.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * let $ul = $body.find("ul");
 * let $table = $(tag("table"));
 * let $thead = $(tag("thead"));
 * let $tr1 = $(tag("tr"));
 * let $th = $(tag("th"));
 * let $tbody = $(tag("tbody"));
 * let $tr2 = $(tag("tr"));
 * let $td= $(tag("td"));
 * let $tfoot = $(tag("tfoot"));
 * let $tableClone;
 *
 * $table.append($thead.append($tr1.append($th)));
 * $table.append($tbody.append($tr2.append($td)));
 * $table.append($tfoot);
 *
 * // create a clone to compare dumped and non-dumped tables side-by-side
 * $tableClone = $table.clone();
 * $tableClone.addClass("table-clone");
 * $ul.after($table);
 * $ul.after($tableClone);
 *
 * $tableClone.dumpTable();
 * // => Returns: original Cheerio object associated with $tableClone
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div class="table-clone mw-was-table">
 * //      &lt;div class="mw-was-thead">
 * //        &lt;div class="mw-was-th">&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tbody">
 * //        &lt;div class="mw-was-td>&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tfoot">&lt;/div>
 * //    &lt;/div>
 * //    &lt;table>
 * //      &lt;thead>
 * //        &lt;th>&lt;/th>
 * //      &lt;/thead>
 * //      &lt;tbody>
 * //        &lt;td>&lt;/td>
 * //      &lt;/tbody>
 * //      &lt;tfoot>&lt;/tfoot>
 * //    &lt;/table>
 */
cheerio.prototype.dumpTable = function() {
  this.each(function(){
    let nodeName = "";
    if( this.name === "table" ) {
      cheerio(this).name("div")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("style")
        .removeAttr("cellpadding")
        .removeAttr("cellspacing")
        .removeAttr("colspan")
        .removeAttr("rowspan")
        .addClass("mw-was-table")
        .find("thead, tbody, tfoot, tr, td, th").each(function(){
          nodeName = this.name;
          cheerio(this).name("div")
            .removeAttr("width")
            .removeAttr("height")
            .removeAttr("style")
            .removeAttr("cellpadding")
            .removeAttr("cellspacing")
            .removeAttr("colspan")
            .removeAttr("rowspan")
            .addClass("mw-was-" + nodeName);
        });
    }
  });
  return this;
}

/**
 * @method revertDumpTable
 * @summary moov_cheerio
 * @memberof $
 * @description Reverts the cheerio.dumpTable back to a table, using the
 * ".mw-was-" classes ascribed by calls to the original .dumpTable() or
 * .dumpTables() methods.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * let $ul = $body.find("ul");
 * let $table = $(tag("table"));
 * let $thead = $(tag("thead"));
 * let $tr1 = $(tag("tr"));
 * let $th = $(tag("th"));
 * let $tbody = $(tag("tbody"));
 * let $tr2 = $(tag("tr"));
 * let $td= $(tag("td"));
 * let $tfoot = $(tag("tfoot"));
 *
 * $table.append($thead.append($tr1.append($th)));
 * $table.append($tbody.append($tr2.append($td)));
 * $table.append($tfoot);
 *
 * $ul.after($table);
 * $body.dumpTables();
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div class="mw-was-table">
 * //      &lt;div class="mw-was-thead">
 * //        &lt;div class="mw-was-th">&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tbody">
 * //        &lt;div class="mw-was-td>&lt;/div>
 * //      &lt;/div>
 * //      &lt;div class="mw-was-tfoot">&lt;/div>
 * //    &lt;/div>
 *
 * $table.revertDumpTable();
 * // => Returns: original Cheerio object associated with $table
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;table class="mw-no-changes mw-table-dump-reverted">
 * //      &lt;thead class="mw-table-dump-reverted-thead">
 * //        &lt;th class="mw-table-dump-reverted-th">&lt;/th>
 * //      &lt;/thead>
 * //      &lt;tbody class="mw-table-dump-reverted-tbody">
 * //        &lt;td class="mw-table-dump-reverted-td">&lt;/td>
 * //      &lt;/tbody>
 * //      &lt;tfoot class="mw-table-dump-reverted-tfoot">&lt;/tfoot>
 * //    &lt;/table>
 */
cheerio.prototype.revertDumpTable = function() {
  this.each(function(){
    let node = cheerio(this);
    let nodeName = "";

    if(node.hasClass('mw-was-table')) {
      node.name("table")
        .removeClass('mw-was-table')
        .addClass('mw-no-changes mw-table-dump-reverted')
        .find(".mw-was-thead, .mw-was-tbody, .mw-was-tfoot, .mw-was-tr, .mw-was-td, .mw-was-th").each(function() {
            nodeName = cheerio(this).attr('class').match(/mw-was-(.+?)(\s|$)/)[1];
            cheerio(this)
              .removeClass('mw-was-thead mw-was-tbody mw-was-tfoot mw-was-tr mw-was-td mw-was-th')
              .addClass('mw-table-dump-reverted-' + nodeName)
              .name(nodeName);
        });
    }
  });
  return this;
}

/**
 * @method domManipulator
 * @summary moov_cheerio
 * @memberof $
 * @description Manipulates the DOM elements around each of the elements in the
 * matched set, by creating new or moving existing elements around them. Generic
 * wrapper of the .create() and .move() methods (see for more details on
 * positioning specifics).
 * @param {String|Object} element A string for an element name, or a Cheerio
 * object containing a matched set
 * @param {String} position A string for the position where the element should
 * be created ("top", "bottom", "before", or "after").
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Create and place an element and move it to a position
 * $body.find("ul").domManipulator("li", "top");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li>&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Create and place an element with attributes passed in
 * $body.find("ul").domManipulator("li", "top", {content: "Content of the li", id: "test"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li id="test">Content of the li&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Move an existing element to a position
 * $body.find(".pear").domManipulator($body.find(".orange"), "after");
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //    &lt;/ul>
 * @example
 * // "Create" a new element using tag() (i.e. move it from memory to a position)
 * $body.find(".pear").domManipulator($(tag("li", {id: "test"})), "after");
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li id="test">&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.domManipulator = function(element, position, options) {
    let currentElement = this;

    options = options || {};

    if(typeof element === 'undefined') {
        throw new TypeError("Cheerio domManipulator - the element param must be an object or a string");
    }

    if(typeof position === 'undefined') {
        throw new TypeError("Cheerio domManipulator - the position param must be a string");
    }

    element = typeof element === 'string'
                    ?
                        cheerio(!/&lt;.*?>/.test(element)
                            ? tag(element)
                            : element)
                    : element;

    if(!element.length) {
        return this;
    }

    if(options.content) {
        element.text(options.content);
        delete options.content;
    }

    if(Object.keys(options).length) {
        element.attr(options);
    }

    //Data dictionary of cheerio positions
    let positions = {
        top     : 'prepend',
        bottom  : 'append',
        after   : 'after',
        before  : 'before'
    };

    //Get cheerio position(it will be used as cheerio function, like $('.element').append..)
    let cheerioPosition = positions[position];

    if(typeof cheerioPosition === 'undefined') {
        throw new TypeError("Cheerio Create - The position " + position + ' doesn\'t exist.');
    }

    //Execute the cheerio function
    currentElement[cheerioPosition](element);

    return currentElement;
};

/**
 * @method create
 * @summary moov_cheerio
 * @memberof $
 * @description Creates a new element for each of the elements in the matched
 * set, at the specified position.
 * @param {String} element A string for an element name.
 * @param {String} position A string for the position where the element should
 * be created ("top", "bottom", "before", or "after").
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Create and place an element and move it to a position
 * $body.find("ul").create("li", "top");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li>&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Create and place an element with attributes passed in
 * $body.find("ul").create("li", "top", {content: "Content of the li", id: "test"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li id="test">Content of the li&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // "Create" a new element using tag() (i.e. move it from memory to a position)
 * $body.find("ul").create($(tag("li", {id: "test"})), "top");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li id="test">&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.create = function(element, position, options) {
    if(typeof element === 'undefined') {
        throw new TypeError("Cheerio create - the element param must be an object or a string");
    }

    if(typeof position === 'undefined') {
        throw new TypeError("Cheerio create - the position param must be a string");
    }

    this.domManipulator.apply(this, arguments);
    return this;
};

/**
 * @method createTop
 * @summary moov_cheerio
 * @memberof $
 * @description Creates a new element at the top of each element in the matched
 * set. Alias for the legacy .create_top() method.
 * @param {String} element A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Create and place an element and move it to a position
 * $body.find("ul").createTop("li");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li>&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Create and place an element with attributes passed in
 * $body.find("ul").createTop("li", {content: "Content of the li", id: "test"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li id="test">Content of the li&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // "Create" a new element using tag() (i.e. move it from memory to a position)
 * $body.find("ul").createTop($(tag("li", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li id="test">&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.createTop = cheerio.prototype.create_top = function(element, options) {
  this.create.call(this, element, 'top', options);
  return this;
};

/**
 * @method createBottom
 * @summary moov_cheerio
 * @memberof $
 * @description Creates a new element at the bottom of each element in the
 * matched set. Alias for the legacy .create_bottom() method.
 * @param {String} element A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Create and place an element and move it to a position
 * $body.find("ul").createBottom("li");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li>&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Create and place an element with attributes passed in
 * $body.find("ul").createBottom("li", {content: "Content of the li", id: "test"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li id="test">Content of the li&lt;/li>
 * //    &lt;/ul>
 * @example
 * // "Create" a new element using tag() (i.e. move it from memory to a position)
 * $body.find("ul").createBottom($(tag("li", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li id="test">&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.createBottom = cheerio.prototype.create_bottom = function(element, options) {
  this.create.call(this, element, 'bottom', options);
  return this;
};

/**
 * @method createAfter
 * @summary moov_cheerio
 * @memberof $
 * @description Creates a new element after each element in the matched set.
 * Alias for the legacy .create_after() method.
 * @param {String} element A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Create and place an element and move it to a position
 * $body.find("ul").createAfter("div");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div>&lt;/div>
 * @example
 * // Create and place an element with attributes passed in
 * $body.find("ul").createAfter("div", {content: "Content of the div", id: "test"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div id="test">Content of the div&lt;/div>
 * @example
 * // "Create" a new element using tag() (i.e. move it from memory to a position)
 * $body.find("ul").createAfter($(tag("div", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div id="test">&lt;/div>
 */
cheerio.prototype.createAfter = cheerio.prototype.create_after = function(element, options) {
  this.create.call(this, element, 'after', options);
  return this;
};

/**
 * @method createBefore
 * @summary moov_cheerio
 * @memberof $
 * @description Creates a new element before each element in the matched set.
 * Alias for the legacy .create_before() method.
 * @param {String} element A string for an element name.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Create and place an element and move it to a position
 * $body.find("ul").createBefore("div");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;div>&lt;/div>
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Create and place an element with attributes passed in
 * $body.find("ul").createBefore("div", {content: "Content of the div", id: "test"});
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;div id="test">Content of the div&lt;/div>
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // "Create" a new element using tag() (i.e. move it from memory to a position)
 * $body.find("ul").createBefore($(tag("div", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;div id="test">&lt;/div>
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.createBefore = cheerio.prototype.create_before = function(element, options) {
  this.create.call(this, element, 'before', options);
  return this;
};

/**
 * @method move
 * @summary moov_cheerio
 * @memberof $
 * @description Moves all elements in an input matched set to a specified
 * position of each element in the selected matched set. If there's more than
 * one element in the matched set for the target, each "moved" element is
 * duplicated.
 * @param {Object} element A Cheerio object containing a matched set.
 * @param {String} position A string for a position where the element should be
 * moved ("top", "bottom", "before", or "after").
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs to add to or replace any existing set of attributes.
 * @param {Object} [options.content] A reserved property name within the options
 * object allowing for the text node content of the element to be changed.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Move an existing element to a position
 * $body.find(".pear").move($body.find(".orange"), "after");
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Move a new element from memory to a position
 * $body.find("ul").move($(tag("li", {id: "test"})), "bottom");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li id="test">&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.move = function(element, position, options) {
    if(typeof element === 'undefined' || Object.prototype.toString.call(element) !== '[object Object]') {
        throw new TypeError("Cheerio create - the element param must be an object");
    }

    if(typeof position === 'undefined') {
        throw new TypeError("Cheerio create - the position param must be a string");
    }

    this.domManipulator.apply(this, arguments);
    return this;
};

/**
 * @method moveTop
 * @summary moov_cheerio
 * @memberof $
 * @description Moves all elements in an input matched set to the top of each
 * element in the selected matched set. If there's more than one element in the
 * selected matched set, each "moved" element is duplicated. Alias for the
 * legacy .move_top() method.
 * @param {Object} element A Cheerio object containing a matched set.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs to add to or replace any existing set of attributes.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Move an existing element to a position
 * $body.find("ul").moveTop($body.find(".orange"));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Move a new element from memory to a position
 * $body.find("ul").moveTop($(tag("li", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li id="test">&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.moveTop = cheerio.prototype.move_top = function(element, options) {
  this.move.call(this, element, 'top', options);
  return this;
};

/**
 * @method moveBottom
 * @summary moov_cheerio
 * @memberof $
 * @description Moves all elements in an input matched set to the bottom of each
 * element in the selected matched set. If there's more than one element in the
 * selected matched set, each "moved" element is duplicated. Alias for the
 * legacy .move_bottom() method.
 * @param {Object} element A Cheerio object containing a matched set.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs to add to or replace any existing set of attributes.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Move an existing element to a position
 * $body.find("ul").moveBottom($body.find(".orange"));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Move a new element from memory to a position
 * $body.find("ul").moveBottom($(tag("li", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li id="test">&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.moveBottom = cheerio.prototype.move_bottom = function(element, options) {
  this.move.call(this, element, 'bottom', options);
  return this;
};

/**
 * @method moveAfter
 * @summary moov_cheerio
 * @memberof $
 * @description Moves all elements in an input matched set after each element in
 * the selected matched set. If there's more than one element in the selected
 * matched set, each "moved" element is duplicated. Alias for the legacy
 * .move_after() method.
 * @param {Object} element A Cheerio object containing a matched set.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs to add to or replace any existing set of attributes.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Move an existing element to a position
 * $body.find(".pear").moveAfter($body.find(".orange"));
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Move a new element from memory to a position
 * $body.find("ul").moveAfter($(tag("div", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * //    &lt;div id="test">&lt;/div>
 */
cheerio.prototype.moveAfter = cheerio.prototype.move_after = function(element, options) {
  this.move.call(this, element, 'after', options);
  return this;
};

/**
 * @method moveBefore
 * @summary moov_cheerio
 * @memberof $
 * @description Moves all elements in an input matched set before each element
 * in the selected matched set. If there's more than one element in the selected
 * matched set, each "moved" element is duplicated. Alias for the legacy
 * .move_before() method.
 * @param {Object} element A Cheerio object containing a matched set.
 * @param {Object} [options] An object containing a list of HTML attribute-value
 * pairs to add to or replace any existing set of attributes.
 * @param {Object} [options.content] A reserved property name within the options
 * object containing the content of the element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Move an existing element to a position
 * $body.find(".pear").moveBefore($body.find(".apple"));
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * // Move a new element from memory to a position
 * $body.find("ul").moveBefore($(tag("div", {id: "test"})));
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;div id="test">&lt;/div>
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear&lt;/li>
 * //    &lt;/ul>
 */
cheerio.prototype.moveBefore = cheerio.prototype.move_before = function(element, options) {
  this.move.call(this, element, 'before', options);
  return this;
};

/**
 * @method prependText
 * @summary moov_cheerio
 * @memberof $
 * @description Prepends an input string to each element in the matched set.
 * This coerces any text or any children into text, before prepending the input
 * string.
 * @param {string} str Text to be prepended for each matched element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".pear").prependText("extra text, ");
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">extra text, Pear&lt;/li>
 * //    &lt;/ul>
 * @example
 * $body.find("ul").prependText("extra text, ");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      extra text,
 * //      Apple
 * //      Orange
 * //      Pear
 * //    &lt;/ul>
 */
cheerio.prototype.prependText = function(str) {
  this.each(function(i, elem) {
    var currentString = cheerio(elem).text();
    cheerio(elem).text(str + currentString);
  });
  return this;
};

/**
 * @method appendText
 * @summary moov_cheerio
 * @memberof $
 * @description Appends an input string to each element in the matched set. This
 * coerces any text or any children into text, before appending the input
 * string.
 * @param {string} str Text to be appended for each matched element.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * $body.find(".pear").appendText(", extra text");
 * // => Returns: original Cheerio object originally with $body.find(".pear")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //      &lt;li class="orange">Orange&lt;/li>
 * //      &lt;li class="pear">Pear, extra text&lt;/li>
 * //    &lt;/ul>
 * @example
 * $body.find("ul").appendText(", extra text");
 * // => Returns: original Cheerio object originally with $body.find("ul")
 * // => HTML output:
 * //    &lt;ul id="fruits">
 * //      Apple
 * //      Orange
 * //      Pear
 * //    , extra text
 * //    &lt;/ul>
 */
cheerio.prototype.appendText = function(str) {
  this.each(function(i, elem) {
    var currentString = cheerio(elem).text();
    cheerio(elem).text(currentString + str);
  });
  return this;
};

/**
 * @method makeToggler
 * @summary moov_cheerio
 * @memberof $
 * @description Creates a Uranium toggler using toggler-specific data-attributes
 * and new class names.
 * @param {Object} options An object containing specified toggler options.
 * @param {String} options.container A string for the selector for the toggler
 * container (data-ur-set="toggler").
 * @param {String} options.button A string for the selector for the toggler
 * button (data-ur-toggler-component="button").
 * @param {String} options.content A string for the selector for the toggler
 * content (data-ur-toggler-component="content").
 * @param {String} [options.skin] A string for a class that "skins" the toggler
 * container.
 * @param {String} [options.viewMoreText] A string for the text of the main
 * category. To be used in conjunction with the `wrapLink` setting.
 * @param {String} [options.wrapLink] A string for an element name to wrap
 * around the "View More" button (given by the `viewMoreText` setting above),
 * which will have the class "mw-wrap-link-toggler". The class and the Uranium
 * data-attribute for the button element must be set manually if this setting is
 * given.
 * @param {Boolean} [options.keepOpened] A boolean to prevent any Uranium
 * attributes from being added, keeping all toggler content elements opened.
 * @return {Object} The updated form of the original Cheerio matched-set object.
 * @example
 * // Simple Toggler
 * let $button = $(tag("a", {href: "#"}, "Fruits"));
 * let $wrapper;
 * let $pageContent;
 *
 * $body.find("ul").wrap("div", {class: "wrapper"});
 * $wrapper = $body.find(".wrapper");
 * $wrapper.prepend($button);
 * $wrapper.wrap("div", {id: "pageContent"});
 * $pageContent = $body.find("#pageContent");
 *
 * $pageContent.makeToggler({
 *   container: ".wrapper",
 *   button: "a",
 *   content: "ul"
 * });
 * // => Returns: original Cheerio object containing the `#pageContent` element
 * // => HTML output:
 * //    &lt;div id="pageContent" class="mw-toggler-main-wrap">
 * //      &lt;div class="wrapper mw-toggle-depth-1 mw-toggler-container mw-default-toggler" data-ur-set="toggler">
 * //        &lt;a href="#" class="mw-toggler-button" data-ur-toggler-component="button" data-ur-state="disabled">Fruits&lt;/a>
 * //        &lt;ul id="fruits" class="mw-toggler-content" data-ur-toggler-component="content" data-ur-state="disabled">
 * //          &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //          &lt;li class="orange">Orange&lt;/li>
 * //          &lt;li class="pear">Pear&lt;/li>
 * //        &lt;/ul>
 * //      &lt;/div>
 * //    &lt;/div>
 * @example
 * // Toggler with skin
 * let $button = $(tag("a", {href: "#"}, "Fruits"));
 * let $wrapper;
 * let $pageContent;
 *
 * $body.find("ul").wrap("div", {class: "wrapper"});
 * $wrapper = $body.find(".wrapper");
 * $wrapper.prepend($button);
 * $wrapper.wrap("div", {id: "pageContent"});
 * $pageContent = $body.find("#pageContent");
 *
 * $pageContent.makeToggler({
 *   container: ".wrapper",
 *   button: "a",
 *   content: "ul",
 *   skin: "mw-blue-toggler"
 * });
 * // => Returns: original Cheerio object containing the `#pageContent` element
 * // => HTML output:
 * //    &lt;div id="pageContent" class="mw-toggler-main-wrap mw-blue-toggler-wrap">
 * //      &lt;div class="wrapper mw-toggle-depth-1 mw-toggler-container mw-default-toggler mw-blue-toggler" data-ur-set="toggler">
 * //        &lt;a href="#" class="mw-toggler-button" data-ur-toggler-component="button" data-ur-state="disabled">Fruits&lt;/a>
 * //        &lt;ul id="fruits" class="mw-toggler-content" data-ur-toggler-component="content" data-ur-state="disabled">
 * //          &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //          &lt;li class="orange">Orange&lt;/li>
 * //          &lt;li class="pear">Pear&lt;/li>
 * //        &lt;/ul>
 * //      &lt;/div>
 * //    &lt;/div>
 * @example
 * // Toggler with viewMoreText and wrapLink
 * let $button = $(tag("a", {href: "/fruits"}, "Fruits"));
 * let $wrapper;
 * let $pageContent;
 *
 * $body.find("ul").wrap("div", {class: "wrapper"});
 * $wrapper = $body.find(".wrapper");
 * $wrapper.prepend($button);
 * $wrapper.wrap("div", {id: "pageContent"});
 * $pageContent = $body.find("#pageContent");
 *
 * $pageContent.makeToggler({
 *   container: ".wrapper",
 *   button: "a",
 *   content: "ul",
 *   wrapLink: "li",
 *   viewMoreText: "View all"
 * });
 * $pageContent.find(".mw-toggler-container").children("div").attributes({
 *   class: "mw-toggler-button",
 *   "data-ur-toggler-component": "button"
 * });
 * // => Returns: original Cheerio object containing the `#pageContent` element
 * // => HTML output:
 * //    &lt;div id="pageContent" class="mw-toggler-main-wrap">
 * //      &lt;div class="wrapper mw-toggle-depth-1 mw-toggler-container mw-default-toggler" data-ur-set="toggler">
 * //        &lt;div data-ur-toggler-component="button">Fruits&lt;/div>
 * //        &lt;ul id="fruits" class="mw-toggler-content" data-ur-toggler-component="content" data-ur-state="disabled">
 * //          &lt;li class="mw-wrap-link-toggler">
 * //            &lt;a href="/fruits">View all&lt;/a>
 * //          &lt;/li>
 * //          &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //          &lt;li class="orange">Orange&lt;/li>
 * //          &lt;li class="pear">Pear&lt;/li>
 * //        &lt;/ul>
 * //      &lt;/div>
 * //    &lt;/div>
 * @example
 * // Toggler with keepOpened 
 * let $button = $(tag("a", {href: "#"}, "Fruits"));
 * let $wrapper;
 * let $pageContent;
 *
 * $body.find("ul").wrap("div", {class: "wrapper"});
 * $wrapper = $body.find(".wrapper");
 * $wrapper.prepend($button);
 * $wrapper.wrap("div", {id: "pageContent"});
 * $pageContent = $body.find("#pageContent");
 *
 * $pageContent.makeToggler({
 *   container: ".wrapper",
 *   button: "a",
 *   content: "ul",
 *   keepOpened: true
 * });
 * // => Returns: original Cheerio object containing the `#pageContent` element
 * // => HTML output:
 * //    &lt;div id="pageContent" class="mw-toggler-main-wrap mw-blue-toggler-wrap">
 * //      &lt;div class="wrapper mw-toggle-depth-1 mw-toggler-container mw-default-toggler">
 * //        &lt;a href="#" class="mw-toggler-button">Fruits&lt;/a>
 * //        &lt;ul id="fruits" class="mw-toggler-content">
 * //          &lt;li class="apple" data-which="fuji">Apple&lt;/li>
 * //          &lt;li class="orange">Orange&lt;/li>
 * //          &lt;li class="pear">Pear&lt;/li>
 * //        &lt;/ul>
 * //      &lt;/div>
 * //    &lt;/div>
 */
cheerio.prototype.makeToggler = function(options) {
    if(Object.prototype.toString.call(options) !== '[object Object]') {
        throw new TypeError("Cheerio makeToggler - the options should an object");
    }

    let wrap = this;
    let container = wrap.find(options.container);
    let wrapLink = options.wrapLink;
    let skin = options.skin;

    wrap.addClass('mw-toggler-main-wrap');
    container.removeIfEmpty();

    if(!container.length) {
        return this;
    }

    options.content = options.content || '';
    wrap.children(container).addClass('mw-toggle-depth-1');

    // Wrap link
    if(wrapLink) {

        let firstDepthButtons = wrap.find('.mw-toggle-depth-1').children(options.button);

        if(options.content === '') {
            throw new TypeError("Cheerio makeToggler - the option.content must be passed if wrapLink is required");
        }

        firstDepthButtons.each(function () {
            let firstDepthButton = cheerio(this);
            let firstDepthContainer = firstDepthButton.parent();
            let firstDepthContent = firstDepthContainer.children(options.content);

            if(wrapLink &amp;&amp; firstDepthButton.is('a')) {
                let buttonCopy = firstDepthButton.clone();
                buttonCopy.text(options.viewMoreText || 'See all');

                buttonCopy = cheerio(tag(wrapLink, { class: 'mw-wrap-link-toggler' })).append(buttonCopy);

                firstDepthContent.prepend(buttonCopy);
                firstDepthButton.name('div').removeAttr('href');
            }
        });

        container = wrap.find(options.container);
    }

    container.each(function () {
        container = cheerio(this);

        let button = container.children(options.button, '.mw-toggler-was-link-button');
        let content = container.children(options.content);

        container.addClass('mw-toggler-container mw-default-toggler');

        if(skin) {
          container.addClass(skin);
          container.closest('.mw-toggler-main-wrap').addClass(skin + '-wrap');
        }

        button.addClass('mw-toggler-button');

        if(button.find('img').length || button.find('.mw-icon').length) {
          let togglerIcon = button.children('img');

          if(!togglerIcon.length) {
            togglerIcon = button.children('.mw-icon');
          }

          togglerIcon.addClass('mw-toggler-button-icon');
          button.wrapTextChildren('span', { class: 'mw-toggler-button-text' });
          button.filter(':not(.mw-toggler-button-icon)').wrapTogether('span', { class: 'mw-toggler-button-content' });
          button.closest('.mw-toggler-container').addClass('mw-toggler-with-icon');
        }

        if(content.children().length) {
          let urState = typeof options.keepOpened !== 'undefined' ? 'enabled' : 'disabled';
          content.addClass('mw-toggler-content');

          if(!options.keepOpened) {
            container.attr('data-ur-set', 'toggler');
            content.attr({
                      'data-ur-toggler-component': 'content',
                      'data-ur-state': urState
                    });

            button.attr({
                    'data-ur-toggler-component': 'button',
                    'data-ur-state': urState
                   });
          }

        } else {
            container.addClass('mw-toggler-no-content');
        }
    });

    return this;
};

module.exports = {
    cheerio: cheerio,
    tag: tag,
    txt: txt
};
</code></pre>
        </article>
    </section>





      <div class="timestamp">
          <i>Last updated Wed Nov 02 2016 17:49:34 GMT+0000 (UTC)</i>
      </div>
  </div>
</div>
</body>
